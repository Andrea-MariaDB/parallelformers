Search.setIndex({docnames:["index","intro/CONTRIBUTING","intro/FAQ","intro/INTRO","intro/POLICY","intro/SUPPORTED_MODELS","parallel/Engine","parallel/Process","parallel/Replacing","parallel/Slicing","parallelize/Parallelize","policy/Auto","policy/Policy","utils/Attr_utils","utils/Dist_utils"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":4,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,sphinx:56},filenames:["index.rst","intro/CONTRIBUTING.md","intro/FAQ.md","intro/INTRO.md","intro/POLICY.md","intro/SUPPORTED_MODELS.md","parallel/Engine.rst","parallel/Process.rst","parallel/Replacing.rst","parallel/Slicing.rst","parallelize/Parallelize.rst","policy/Auto.rst","policy/Policy.rst","utils/Attr_utils.rst","utils/Dist_utils.rst"],objects:{"parallelformers.parallel":{engine:[6,0,0,"-"],process:[7,0,0,"-"],replacing:[8,0,0,"-"],slicing:[9,0,0,"-"]},"parallelformers.parallel.engine":{ParallelEngine:[6,1,1,""]},"parallelformers.parallel.engine.ParallelEngine":{create_process_group:[6,2,1,""],parallelize:[6,2,1,""]},"parallelformers.parallel.process":{ForkingPickler:[7,1,1,""],ParallelProcess:[7,1,1,""]},"parallelformers.parallel.process.ForkingPickler":{dumps:[7,2,1,""],loads:[7,2,1,""],register:[7,2,1,""]},"parallelformers.parallel.process.ParallelProcess":{check_picklable:[7,2,1,""],destroy:[7,2,1,""],inference:[7,2,1,""],run:[7,2,1,""],set_environ:[7,2,1,""]},"parallelformers.parallel.replacing":{TensorReplacer:[8,1,1,""]},"parallelformers.parallel.replacing.TensorReplacer":{auto_policy:[8,2,1,""],make_megatron_layer:[8,2,1,""],preprocess:[8,2,1,""],replace_modules:[8,2,1,""],replace_orig_to_megatron_modules:[8,2,1,""],replace_user_define_modules:[8,2,1,""],set_layer_size:[8,2,1,""],set_parameters:[8,2,1,""]},"parallelformers.parallel.slicing":{TensorSlicer:[9,1,1,""]},"parallelformers.parallel.slicing.TensorSlicer":{column_slice:[9,2,1,""],row_slice:[9,2,1,""],slice_tensor:[9,2,1,""],slice_weight_and_bias:[9,2,1,""]},"parallelformers.parallelize":{parallelize:[10,1,1,""]},"parallelformers.parallelize.parallelize":{deparallelize:[10,2,1,""],hijack:[10,2,1,""],init_environments:[10,2,1,""],parallelize:[10,2,1,""],preprocess_for_wav2vec:[10,2,1,""],register_hijack_methods:[10,2,1,""],register_memory_methods:[10,2,1,""]},"parallelformers.policies.base":{auto:[11,0,0,"-"],policy:[12,0,0,"-"]},"parallelformers.policies.base.auto":{AutoPolicy:[11,1,1,""]},"parallelformers.policies.base.auto.AutoPolicy":{available:[11,2,1,""],get_policy:[11,2,1,""]},"parallelformers.policies.base.policy":{Layer:[12,1,1,""],Policy:[12,1,1,""]},"parallelformers.policies.base.policy.Layer":{bias:[12,3,1,""],ignore_checker:[12,3,1,"id3"],n_fused:[12,3,1,"id0"],replace:[12,3,1,"id1"],reversed:[12,3,1,"id2"],weight:[12,3,1,""]},"parallelformers.policies.base.policy.Policy":{attn_out:[12,2,1,""],attn_qkv:[12,2,1,""],mlp_in:[12,2,1,""],mlp_out:[12,2,1,""],original_layer_class:[12,2,1,""],replace_arguments:[12,2,1,""],replace_modules:[12,2,1,""]},"parallelformers.utils":{attr_utils:[13,0,0,"-"],dist_utils:[14,0,0,"-"]},"parallelformers.utils.attr_utils":{igetattr:[13,4,1,""],isetattr:[13,4,1,""],rgetattr:[13,4,1,""],rhasattr:[13,4,1,""],rsetattr:[13,4,1,""]},"parallelformers.utils.dist_utils":{AllReduceConv1D:[14,1,1,""],AllReduceLinear:[14,1,1,""],AllReduceQuantLinear:[14,1,1,""],ParallelModule:[14,1,1,""]},"parallelformers.utils.dist_utils.AllReduceConv1D":{forward:[14,2,1,""],training:[14,3,1,""]},"parallelformers.utils.dist_utils.AllReduceLinear":{forward:[14,2,1,""],in_features:[14,3,1,""],out_features:[14,3,1,""],weight:[14,3,1,""]},"parallelformers.utils.dist_utils.AllReduceQuantLinear":{allreduce_linear_layer:[14,2,1,""],forward:[14,2,1,""],training:[14,3,1,""]},"parallelformers.utils.dist_utils.ParallelModule":{allreduce:[14,2,1,""],training:[14,3,1,""]},parallelformers:{parallelize:[10,0,0,"-"]}},objnames:{"0":["py","module","Python module"],"1":["py","class","Python class"],"2":["py","method","Python method"],"3":["py","attribute","Python attribute"],"4":["py","function","Python function"]},objtypes:{"0":"py:module","1":"py:class","2":"py:method","3":"py:attribute","4":"py:function"},terms:{"0":[2,3,10],"00gb":3,"1":[2,4,10],"1024":3,"127":10,"12gb":3,"15":3,"1d":14,"2":[2,4,7,10,13],"251904":3,"251905":3,"2720":3,"2721":3,"29500":[2,10],"29501":2,"2966":3,"2967":3,"2mb":2,"3":[2,7,10,13],"32":14,"4":[2,4,10],"4h":12,"5":10,"5000":3,"5120":3,"5121":3,"72gb":3,"7b":[3,10],"8":[3,7,14],"abstract":12,"byte":7,"case":[4,12],"class":[0,6,7,8,9,10,11,12,14],"default":[2,3,6,7,8,10,13],"do":[2,10,12],"final":4,"function":[10,13],"import":[3,4,10],"int":[6,7,8,9,10,12,14],"new":[4,7],"return":[3,4,6,7,8,9,10,11,12],"static":[2,8,11,12],"switch":3,"true":[2,3,4,7,10,13,14],"try":[2,7],And:[2,3],At:5,Be:3,But:2,For:[2,3,4,12],If:[2,3,4,7],In:[2,3,4,12],It:[2,3,4,7,10],NOT:2,The:[2,3,4,6,7,12],There:[2,10],These:12,To:[3,4,10],__name__:3,_pickl:7,abc:12,abl:12,about:[2,4],access:12,accessor:12,across:2,actual:2,add:[4,10],addit:[2,3],address:10,adopt:2,affect:3,after:[1,2],again:2,albert:5,all:[2,3,5,10,12,14],alloc:[2,3],allow:4,allreduc:14,allreduce_linear_lay:14,allreduceconv1d:14,allreducelinear:[12,14],allreducequantlinear:14,alreadi:2,also:[2,4,12],although:2,alwai:12,an:[3,7,9,10,12],ani:[7,8,10,12],anoth:10,app:3,appli:[8,12],appropri:11,ar:[4,5,7,12],area:[2,3,12],arg:[7,13],argument:[4,7,10,12],ascii:7,attent:[2,3,4,12,13],attn_out:12,attn_qkv:12,attr:13,attr_util:13,attribut:[0,8,9,12],auto:0,auto_polici:8,automat:[3,7,11],automodelforcausallm:[3,10],autopolici:[2,4,8,11],autotoken:[3,10],avail:11,b:3,back:2,backend:[6,7,10],bart:5,bartattent:4,bartattention_:4,bartencoderlay:12,barthez:5,base:[2,6,7,8,9,10,11,12,13,14],basecontext:7,basic:4,batch_decod:[3,10],becaus:[2,3,4],becom:10,befor:2,below:[4,5,7],bert:[5,12],bertgener:5,bertjapanes:5,bertlay:12,bertweet:5,best:3,between:2,bia:[8,9,12,14],bias:9,bias_bit:14,bias_nam:8,bias_param:8,bigbird:[2,5],bigbirdpegasu:[2,5],bit:7,black:1,blenderbot:5,bool:[6,7,8,9,10,12,14],bort:5,both:3,broke:10,bug:2,byt5:5,cach:3,call:3,callback:7,camembert:5,can:[1,3,4,5,7,12],care:[3,4],chang:[1,2,4,7,10],check:[2,4,7,10],check_pickl:7,checker:2,chunk:12,classmethod:7,clip:5,code:[1,4],collect:12,column:9,column_slic:9,command:3,common:12,commun:[2,10],compat:[2,7],complet:2,conduct:2,config:[4,12],configur:4,configuraion:12,conflict:2,consist:[1,2,12],contain:2,contains:2,context:7,contribut:0,control:[7,10],conv1d:[2,12,14],conv:10,convbert:[2,5],convolut:[2,14],copi:[2,7],costli:3,cpm:5,cpu:[3,6],creat:[6,10,12],create_process_group:6,ctrl:5,cuda:3,cudamalloc:3,cur:3,curl:3,current:[2,5,7,8,10,11],custom:[2,6,7,8],custom_polici:[4,6,7,8,10],dacit:3,daemon:10,data:[7,8,13],dataclass:[7,12],deberta:5,decod:[7,12],def:[3,4],defin:[4,8],deit:5,deparallel:10,depend:[3,12],describ:[9,12],design:12,destroi:7,detach:10,detail:[2,3,4,10],detect:7,detr:5,devic:3,dialogpt:5,dict:[8,9,10,12],dictionari:[7,8,9,11,12],difficult:3,dim:9,dimens:9,direct:9,directori:4,dist_util:14,distilbert:5,distribut:[0,2,6,7,9,10],divid:12,doc:[1,4],doe:[3,10],don:[3,4],dpr:5,due:4,dump:7,dure:2,dynam:2,e:[2,6,10,12],easili:3,effici:3,electra:[5,12],element:12,eleutherai:[3,10],embed:[2,6],embed_dim:4,enabl:10,encod:[2,7,12],encoderdecodermodel:2,end:[2,3,10],engin:0,environ:[7,10],error:[7,12],even:12,event:7,everi:4,exact:3,exampl:[2,3,4,10,12,13],except:7,execut:7,exist:12,experi:2,exst:4,f:[3,10],face:4,factor:2,fals:[12,14],faq:0,find:[8,11],first:[2,12],fix_import:7,flake8:1,flask:3,flaubert:5,flow:10,follow:[2,3,4,5,6,10,12],forkingpickl:7,format:[1,12],forward:[2,10,14],found:2,fp16:[2,3,4,6,7,8,10],framework:2,freed:3,from:[3,4,7,8,10,12],from_pretrain:[3,10],fsmt:5,func:10,function_output:8,funnel:5,fuse:12,g:[2,6,10,12],gb:3,gener:[3,7,10],generate_text:3,get_polici:11,getattr:13,given:7,gpt1:[2,12],gpt2:[2,5,12],gpt2block:12,gpt:[3,5,10,14],gptneo:5,gpu0:3,gpu1:3,gpu:[6,7,8,10,12],gram:2,group:[6,8,9],h:12,ha:4,half:3,handl:7,hasattr:13,have:[2,3,4,12],he:3,head:[2,4],help:2,herbert:5,here:2,hidden:4,hidden_s:4,hijack:10,host:3,how:7,hubert:5,hug:4,huggingfac:[4,5,6,8,10,12],i:5,ibert:14,id:3,igetattr:13,ignor:[7,12],ignore_check:12,implement:[2,4],imposs:[4,10],in_featur:14,includ:5,increas:2,index:[0,13],indic:12,infer:[7,10],inference_mutex:7,init_environ:10,init_method:10,initi:10,input:[2,3,4,7,10,14],inputs_queu:7,insert:12,instanc:7,instead:12,inter:2,intercept:10,introduct:0,invok:3,involv:12,is_bia:9,isetattr:13,isort:1,issu:2,its:[1,2,4],join:10,kb:3,keep:2,kei:12,keyword:7,kwarg:10,languag:[5,12],larg:3,larger:3,layer:[2,5,8,12,13,14],layoutlm:5,leaf:10,leak:2,least:2,led:5,less:3,letter:10,librari:[3,10],like:[3,4,5,12],linear:[12,14],list:[4,5,6,7,8,11,12],lm:[2,9],lm_head:6,load:[3,7],locat:10,log:10,longform:5,lose:10,lowercas:10,luke:5,lxmert:5,m2m100:5,mai:12,main:[2,7,10],make:[1,2,3,8,10],make_megatron_lay:8,manag:4,map:7,marianmt:5,mask:3,master:10,master_addr:10,master_port:[2,10],matrix:2,max_length:3,mb:3,mbart:5,md:3,mechan:2,megatron:[5,8,9],megtraon:8,memori:[2,3],memory_alloc:3,memory_chach:3,memory_reserv:3,memory_summari:3,memoryview:7,mention:2,messi:3,method:[2,4,7,10,12],metric:3,miss:10,mistak:1,mlp:12,mlp_in:12,mlp_out:12,mobil:5,mode:3,model:[4,6,7,8,9,10,11,12,13,14],model_1:2,model_2:2,modeling_util:[2,12,14],modul:[2,6,7,8,10,11,12,14],modulelist:12,monei:3,more:[2,3,4],most:[4,5],mp:7,mp_group:[8,9],mpnet:5,mt5:5,multipl:[3,4,6],multiprocess:[2,7,10],must:[2,4,10],mutex:7,n_fuse:12,name:[3,7,8,10,12],nccl:[2,6,10],need:[2,3,4,7,12],neo:[3,10],new_data:13,new_weight:13,nf:14,nn:[6,7,8,10,11,12,14],no_repeat_ngram_s:[3,10],non:[2,6],none:[3,7,8,10,11,12,13,14],normal:2,note:[2,3,6,7,10,12],notifi:7,now:3,num_attention_head:4,num_beam:[3,10],num_gpu:[2,3,4,6,7,8,10],num_head:4,number:[2,4,6,7,8,10,12],nvidia:3,nx:14,obj:[7,13],object:[2,6,7,8,9,10,11,12],occup:10,occur:7,old:7,one:10,onli:[2,12],oom:3,open:[3,10],openai:[2,5],oper:[2,12],option:[3,7,8,10,11,12],orig_class_name_1:12,orig_class_name_2:12,orig_class_name_3:12,orig_class_name_4:12,origin:[2,6,8,12],original_layer_class:12,other:[2,10],our:2,out_featur:14,output:[3,7,10,12,14],outputs_queu:7,over:10,overal:4,own:[2,4],packag:[2,3],page:0,paper:9,paral:6,parallel:[4,5,8,9,11,12,14],parallel_mutex:7,parallelengin:6,parallelform:[0,4,6,7,8,9,10,11,12,13,14],paralleliz:[2,6],parallelmodul:14,parallelprocess:7,param_name_1:12,param_name_2:12,param_name_3:12,param_name_n:12,paramert:8,paramet:[6,7,8,9,10,11,12],parent:14,partli:2,pass:[2,7,10],past:7,peak:3,pegasu:5,pep8:10,per:12,per_channel:14,perform:[2,6],phobert:5,pickl:7,picklabl:7,pickler:7,pip:3,player:3,pleas:2,plural:3,point:10,polic:4,polici:[2,6,7,8],policy_cl:8,policy_input:9,pool:3,port:[3,10],possibl:2,pre:[4,6,8,10],preciou:3,preprocess:8,preprocess_for_wav2vec:10,present:5,prev_act_scaling_factor:14,print:[3,10],problem:2,process:[0,2,3,6,8,10,12],processgroupnccl:[6,9],program:[3,10,12],project:12,proper:8,prophetnet:[2,5],protocol:7,provid:4,pt:[3,10],python:[2,7],pytorch:[3,6],quant_mod:14,quant_modul:14,quantiz:14,quantlinear:14,queri:12,queue:7,rag:[2,5],rais:7,rank:7,rather:[2,10],read:7,reason:2,recommend:[2,3],recurs:13,reduc:[4,7,12,14],refer:[3,4],reform:5,regist:[7,10],register_hijack_method:10,register_memory_method:10,relat:4,reli:1,remov:10,replac:[0,6,12],replace_argu:12,replace_arguemen:4,replace_arguemnt:4,replace_modul:[8,12],replace_orig_to_megatron_modul:8,replace_user_define_modul:8,represent:[2,7],request:[3,7],requir:[4,8],requries_grad:10,reserv:3,reset_module_class_1:12,reset_module_class_2:12,reset_module_class_3:12,reset_module_class_n:12,reset_value_1:12,reset_value_2:12,reset_value_3:12,reset_value_n:12,resiz:8,respect:[7,12],result:[2,3],retri:3,retribert:5,return_tensor:[3,10],revers:12,rgetattr:13,rhasattr:13,right:3,roberta:[5,12],roform:5,rout:3,row:9,row_slic:9,rsetattr:13,rule:10,run:[1,3,7],s:[2,7,8],safe:10,samll:5,save:3,search:0,second:2,self:[2,4,10],semaphor:2,semophor:2,send:3,serial:2,serializ:2,set:[2,3,7,8,10],set_environ:7,set_layer_s:8,set_paramet:8,setattr:13,sever:[2,10],share:2,should:[2,3,12],show:3,simpl:[3,10],simpli:12,simultan:6,sinc:[2,3],singl:3,size:[2,3,4,8],skip_special_token:3,slice:[2,6,8,9,12],slice_bia:9,slice_tensor:9,slice_weight_and_bia:9,slicer:0,small:[2,3],smaller:3,smi:3,so:[2,4,7,10,12],solv:2,some:[4,10,12],sourc:[3,6,7,8,9,10,11,12,13,14],spawn:[2,10],speech2text:5,speech:5,squeezebert:[2,5],start:[4,7,10],state:[7,10],staticmethod:4,statu:[3,10],store:12,str:[6,7,8,10,12],stream:7,strict:7,string:7,success:3,suffix:8,summari:[3,7],support:[0,7],sure:3,synchron:3,syntax:[4,12],t5:5,t:[3,4],tapa:5,task:7,tell:7,tensor:[0,2,6,10,12,14],tensorreplac:8,tensorslic:9,termin:7,text:3,than:[2,3,10],thei:[2,3,5,12],them:[1,4],therefor:[2,10],thi:[2,3,4,7,10,12],those:3,three:2,through:6,thu:2,token:[3,10],too:[2,3],torch:[3,6,7,8,9,10,11,12,14],tot:3,total:12,train:[6,8,10,14],transfer:[2,10],transform:[2,4,5,6,8,10,12,14],transformerxl:5,transfoxl:12,tupl:[8,9],turn:7,two:[3,7],type:[6,7,8,9,10,11,12],unfortun:2,union:[6,7,8,11],unparallel:2,up:2,upload:6,us:[1,3,4,6,7,8,10,12],usag:3,user:[6,7,8,10],usual:10,v2:5,val:13,valu:12,variabl:[7,10],verbos:[3,7,10],version:7,vision:5,visualbert:5,vit:5,wai:3,want:[2,4,10,12],wav2vec2:5,wav2vec:10,wave2vec2:5,we:[2,4,10,12],web:3,weight:[2,7,8,9,10,12,13,14],weight_bit:14,weight_nam:8,weight_param:8,well:[3,5],when:[4,7,12],whether:[6,7,8,9,10,12],which:7,work:[2,3],world:3,world_siz:[4,12],worth:2,write:[2,4],x:[3,14],xlm:5,xlnet:5,xlsr:5,xxxxxx:3,ye:2,you:[1,2,3,4,12],your:[2,3],your_cod:4,your_ip:3,yourdecoderpolici:4,yourencoderpolici:4,yourpolici:4,yourself:4},titles:["Parallformers: An Efficient Model Parallelization Toolkit for Deployment","Contributing to Parallelformers","FAQ","Introduction","Policy Class","Supported Models","Parallel Engine","Parallel Process","Tensor Replacer","Tensor Slicer","Parallelize","Auto Policy","Policy","Attribute Utils","Distributed Utils"],titleterms:{"1":3,"2":3,"3":3,"4":3,"5":3,"6":3,"7":3,"class":[3,4],"do":3,"function":3,"new":3,an:0,appli:4,ar:[2,3],attribut:13,auto:11,can:2,check:[1,3],contribut:1,creat:3,current:3,custom:4,decreas:2,deploi:3,deploy:0,distribut:14,docker:2,doesn:2,effici:0,engin:6,exactli:2,faq:2,fulli:5,get:3,good:2,gpu:[2,3],guid:1,how:2,huggingfac:3,i:2,indic:0,infer:3,instal:3,intro:0,introduct:3,layer:4,manag:3,mani:2,model:[0,2,3,5],modul:0,multipl:2,n:2,object:4,parallel:[0,2,3,6,7,10],parallelform:[1,3],parallform:0,partli:5,polici:[0,3,4,11,12],process:7,put:3,q:2,qualiti:1,releas:3,replac:8,replace_argu:4,replace_modul:4,same:2,server:3,slicer:9,some:2,start:3,state:3,style:1,support:[2,5],t:2,tabl:0,tensor:[8,9],time:2,toolkit:0,transform:3,unsupport:5,us:2,usag:2,usual:3,util:[0,13,14],when:[2,3],why:[2,3],write:3}})